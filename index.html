<!DOCTYPE html>
<html>
<head>
		<meta charset="utf-8">
		<title>Crime Map - Austin Digital Twin</title> 
		<meta name="description" content="Austin crime data visualization map.">
		<meta name="viewport" content="width=device-width, initial-scale=1">

		<!-- Open Graph tags for social media -->
		<meta property="og:title" content="Crime Map - Austin Digital Twin">
		<meta property="og:description" content="Austin crime data visualization map.">
		<meta property="og:image" content="assets/images/crime_icon.png">
		<meta property="og:url" content="crime.austindigitaltwin.com">

		<!-- Enables Twitter support -->
		<meta name="twitter:card" content="summary">

		<!-- Leaflet requirements -->
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css"
        integrity="sha512-xodZBNTC5n17Xt2atTPuE1HxjVMSvLVW9ocqUKLsCC5CXdbqCmblAshOMAS6/keqq/sMZMZ19scR4PsZChSR7A=="
        crossorigin="" />
		<!-- Make sure you put this AFTER Leaflet's CSS -->
		<script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"
			integrity="sha512-XQoYMqMTK8LvdxXYG3nZ448hOEQiglfqkJs1NOQV44cWnUrBc8PkAOcXy20w0vlaXaVUearIOBhiXZ5V3ynxwA=="
			crossorigin=""></script>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		
		<script src="https://unpkg.com/leaflet.markercluster@1.1.0/dist/leaflet.markercluster.js"></script>
		<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.1.0/dist/MarkerCluster.css" />
		<link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.1.0/dist/MarkerCluster.Default.css" />

		<link rel="stylesheet" href="assets/css/style.css">
		<link rel="stylesheet" href="assets/css/crimeMap.css">

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

	</head>

	<style>
		/* Text alignment for body */
		body {
            text-align: center;
        }
          
        /* Styling h1 tag */
        h1 {
            color: green;
            text-align: center;
        }
          
        /* Styling modal */
        .modal:before {
            content: '';
            display: inline-block;
            height: 100%;
            vertical-align: middle;
            text-align: center;
        }
          
        .modal-dialog {
            display: inline-block;
            vertical-align: middle;
            align-content: center;
        }
          
        .modal .modal-content {
            padding: 20px 20px 20px 20px;
            -webkit-animation-name: modal-animation;
            -webkit-animation-duration: 0.5s;
            animation-name: modal-animation;
            animation-duration: 0.5s;
        }
	</style>

<body>
		<div id="map"></div>

		<div id="spinner">
			<div></div>
			<div></div>
			<div></div>
			<div></div>
		</div>

		<!-- Modal -->
		<div class="modal fade" id="infoModal" role="dialog">
			<div id="InfoBox" class="modal-dialog">
				<!-- Modal content-->
				<div class="modal-content">
					<div class="modal-header">
						<button type="button" class="close" data-dismiss="modal">&times;</button>
						<h4 class="modal-title">Austin Crime Map Information</h4>
					</div>
					<div class="modal-body" style="text-align:left;">
						<h4>About</h4>
						<p>This page provides interactive crime data visualization for Austin, Texas. The map displays various crime incidents including their locations, types, and details.</p>
					
						<h4>Credits</h4>
						<p>Created by the Urban Information Lab under the Good Systems Initiative at The University of Texas at Austin.</p>
						<p>Additional support for this project comes from the Texas Advanced Computing Center.</p>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					</div>
        </div>
        </div>
    </div>

		<section>
			<div style="display: block; background-color: #bf5700; height: 40px; text-align: center; user-select: none;" >
				<div onclick="info()">
					<!-- Logo -->
					<a href="#" onclick="info()" style="float: left; margin-right: 1rem; margin-top:0;">
						<span style="margin-left: 10px; max-height: 25px; margin-top: -5px; display: block; max-width: 100%; height: auto;">
							<img src="assets/images/crime_icon.png" width="50px" height="50px"  xml:space="preserve"> </img>
						</span>
					</a>

					<h2 id="MapTitle" style="float: left; margin-right: 1rem; margin-top:5px; color: white;"><b><a style="color:white" href="#">Austin Crime Map</a></b></h2>
				</div>

				<a href="https://www.urbaninfolab.com/austindigitaltwin" style="float: right; margin-right: 1rem; margin-top:0;">
					<span style="position: absolute; width: 1px; height: 1px; padding: 0; margin: -1px; overflow: hidden; clip: rect(0,0,0,0); border: 0;color: #fff">Urban Info Lab</span> 
					<span style="max-height: 25px; margin-top: 9px; display: block; max-width: 100%; height: auto;">
						<img src="https://sites.utexas.edu/uil/files/2020/05/UIL-Final-Logos-03-e1588717100882.png" width="115px" height="25px" style="display: block; max-width: 100%; height: auto;" alt="Urban Info Lab">
					</span>
				</a>
			</div>
		</section>

		<script type="text/javascript">
			function info(){
				$("#infoModal").modal({backdrop: true});
			}
		</script>

		<script src="assets/js/crimeMap2d.js"></script>
		
		<!-- Simple Usage Instructions Modal -->
		<div id="usageModal" style="display: none; position: fixed; z-index: 10000; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.6); overflow-y: auto;">
			<div style="background-color: #bf5700; margin: 5% auto; padding: 25px; border: 1px solid #888; width: 85%; max-width: 650px; border-radius: 8px; position: relative; max-height: 85vh; overflow-y: auto; color: #fefefe;">
				<span onclick="closeUsageModal()" style="position: absolute; right: 15px; top: 15px; color: #fefefe; font-size: 32px; font-weight: bold; cursor: pointer; line-height: 1;">&times;</span>
				<h2 style="margin-top: 0; color: #fefefe;">Welcome to Austin Crime Map</h2>
				<h3 style="margin-bottom: 20px; border-bottom: 2px solid #fefefe; padding-bottom: 10px; color: #fefefe;">Guide</h3>
				
				<div style="margin-bottom: 18px; display: flex; align-items: flex-start;">
					<div style="color: #fefefe; text-align: left;">
						<strong style="color: #fefefe; display: block; margin-bottom: 5px; text-align: left;">Crime Markers:</strong>
						<span style="text-align: left;">Red markers on the map represent crime incidents. Click on any marker to view detailed information including crime type, location, date, and report number. Markers may be clustered at lower zoom levels - zoom in to see individual markers.</span>
					</div>
				</div>
				
				<div style="text-align: center; margin-top: 25px; padding-top: 20px; border-top: 1px solid rgba(254, 254, 254, 0.3);">
					<button onclick="closeUsageModal()" style="background-color: #fefefe; color: #bf5700; border: none; padding: 12px 40px; font-size: 16px; border-radius: 5px; cursor: pointer; font-weight: bold; transition: background-color 0.3s;" onmouseover="this.style.backgroundColor='#e8e8e8'" onmouseout="this.style.backgroundColor='#fefefe'">Got it!</button>
				</div>
			</div>
		</div>
		
		<script>
			function closeUsageModal() {
				document.getElementById('usageModal').style.display = 'none';
			}
			
			window.onload = function() {
				setTimeout(function() {
					document.getElementById('usageModal').style.display = 'block';
				}, 500);
			};
		</script>
		
		<!-- Instructions for users -->
		<!-- 
		To fix corrupted coordinates in CrimeMap_geocoded.json:
		1. Run: python3 fix_json.py
		2. This creates CrimeMap_geocoded_fixed.json with invalid coordinates set to null
		3. The map will automatically skip records with null coordinates
		
		To attempt geocoding and repair invalid coordinates:
		1. Run: python3 fix_coordinates.py --geocode
		2. Follow prompts to geocode addresses
		3. New file will be created with fixed coordinates
		-->
	</body>
</html>
